<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Counting Cushions</title>
    <style>
        .job-set {
            border: 2px solid #007bff;
            border-radius: 10px;
            padding: 10px;
            margin-bottom: 15px;
            background-color: #eef7ff;
        }
        .summary-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        .summary-table th, .summary-table td {
            border: 1px solid #ddd;
            padding: 8px;
        }
        .summary-table th {
            background-color: #f2f2f2;
        }
        .flash { padding: 10px; border-radius: 5px; margin: 10px 0; }
        .flash.success { background-color: #d4edda; color: #155724; }
        .flash.error { background-color: #f8d7da; color: #721c24; }
    </style>
</head>
<body>
    <h1>Counting Cushions</h1>

    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <div class="flash {{ category }}">{{ message }}</div>
            {% endfor %}
        {% endif %}
    {% endwith %}

    <form method="POST">
        <label>Job Name:
            <select name="job_name">
                {% for job in jobs %}
                    <option value="{{ job }}">{{ job }}</option>
                {% endfor %}
            </select>
        </label><br><br>

        <label>Goal Time (hrs):
            <input type="number" step="0.01" name="goal_time" required>
        </label><br><br>

        <label>Start Time:
            <input type="datetime-local" name="start_time" required>
        </label><br><br>

        <label>End Time:
            <input type="datetime-local" name="end_time" required>
        </label><br><br>

        <button type="submit">Log Job</button>
    </form>

    <h2>Total Goal Time Today: {{ total_goal_time }} hrs</h2>

    <h2>Job Summary for {{ today }}</h2>
    {% for job_set in sets %}
        <div class="job-set">
            <table class="summary-table">
                <thead>
                    <tr>
                        <th>Job Name</th>
                        <th>Goal Time (hrs)</th>
                        <th>Actual Time (hrs)</th>
                        <th>Setup Time (hrs)</th>
                        <th>Date</th>
                    </tr>
                </thead>
                <tbody>
                    {% for job in job_set %}
                        <tr>
                            <td>{{ job.job_name }}</td>
                            <td>{{ job.goal_time_hours }}</td>
                            <td>{{ job.actual_hours }}</td>
                            <td>{{ job.setup_hours }}</td>
                            <td>{{ job.date }}</td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    {% endfor %}
</body>
</html>
